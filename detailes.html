<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Home_Page</title>
        <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>
        <script src="./node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
        <link rel="stylesheet" href="./node_modules/bootstrap/dist/css/bootstrap.min.css">
        <script src="./node_modules/axios/dist/axios.min.js"></script>
    
    <style>
        body{
            background: #f0ecff;
        }
        #add-btn {
        position: fixed;
        bottom: 5%;
      right: 8%;
      width: 70px;
      height: 70px; 
      text-align: center;
      color: white;
      border-radius: 50%;
      font-size: 40px;
       cursor: pointer;
    box-shadow: 0px 10px 10px rgba(0, 0, 0, 0.3);
    }

    #btnn:hover{
background-color: blue;
    }
  

    </style>
    </head>
<body>

<div id="loader" style="border-radius: 30px; width: 80px;height: 80px; background: rgba(237, 239, 237, 0.447); position: fixed; left: 0px; right: 0px; bottom: 0px; top: 0px; margin: auto auto; display: flex; justify-content: center; align-items: center; z-index: 9999;" >
  <div class="lds-spinner" ><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div><div></div></div>

</div>
      
</div>

    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header d-flex justify-content-center align-items-center" >
              <h1 class="modal-title fs-3 color-blue"  id="exampleModalLabel" >Login</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form>
                <div class="mb-3">
                  <label for="recipient-name" class="col-form-label"></label>
                  <input type="text" class="form-control" id="username" value="mohammeddd" placeholder="Username">
                </div>
                <div class="mb-3">
                  <label for="message-text" class="col-form-label"></label>
                  <input type="password" class="form-control" id="password" value="123456" placeholder="password">
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary"  onclick="loginbtn()">Login</button>
            </div>
          </div>
        </div>
      </div> 
    
      <div class="modal fade" id="regesterModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header d-flex justify-content-center align-items-center" >
              <h1 class="modal-title fs-3 color-blue"  id="exampleModalLabel">Register Anew User</h1>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
              <form>
     
                <div class="mb-3">
                  <label for="recipient-name"  class="col-form-label">image</label>
                  <input type="file" class="form-control" id="regester-img-input" value="" placeholder="">
                </div>
    
                <div class="mb-3">
                  <label for="recipient-name" class="col-form-label">name</label>
                  <input type="text" class="form-control" id="regester-name-input" value="aliali100" placeholder="Name">
                </div>
                <div class="mb-3">
                  <label for="recipient-name" class="col-form-label">username</label>
                  <input type="text" class="form-control" id="regester-username-input" value="mohammeddd1" placeholder="Username">
                </div>
                <div class="mb-3">
                  <label for="message-text" class="col-form-label">password</label>
                  <input type="password" class="form-control" id="regester-password-input" value="123456" placeholder="password">
                </div>
              </form>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary"  onclick="regesterbtn()">Regster</button>
            </div>
          </div>
        </div>
      </div> 
    
  <div class="modal fade" id="create-post-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header d-flex justify-content-center align-items-center" >
          <h1 class="modal-title fs-3 color-blue"  id="exampleModalLabel">Create A new Post</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form>
            <div class="mb-3">
              <label for="recipient-name" class="col-form-label">Title</label>
              <input type="text" class="form-control" id="creatpost" value="" placeholder="">
            </div>
            <div class="mb-3">
              <textarea name="" id="creatbody" style="width: 100%; height: 100px; border-color: gray; border-radius: 10px; resize: none;"></textarea>
            </div>
            <div class="mb-3">
              <label for="recipient-name" class="col-form-label">Image</label>
              <input type="file" class="form-control" id="createimage" value="" placeholder="">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary"  onclick="Createbtn()">Create</button>
        </div>
      </div>
    </div>
  </div> 

  <div class="container">
    <div class="d-flex justify-content-center">
<div class="col-9">
    <nav class=" navbar navbar-expand-lg pt-2  rounded shadow  bg-dark" >
        <div class="container-fluid fs-5 ">
          <a class="navbar-brand" style="color: yellow;" href="index.html">Whisper</a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav">
              <li class="nav-item">
                <a class="nav-link active" style="color: white;" aria-current="page" href="index.html">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" style="color: white ; cursor: pointer;"  onclick="mypro()">Profile</a>
              </li>
            </ul>
         <div class="d-flex  w-100 justify-content-end " id="login-div">
            <button type="button" id="loginone" data-bs-toggle="modal"  data-bs-target="#loginModal" class="btn btn-outline-success mx-3 fs-5" >Login </button>
            <button type="button" id="regester" data-bs-toggle="modal" data-bs-target="#regesterModal" id="regester" class="btn btn-outline-success gap-5 fs-5">Register</button>
            
         </div>
         <div class="d-flex  w-100 justify-content-end align-items-center" id="logout-div">
          <img id="nav-img" class="rounded-circle" src="./img_profile/تنزيل.jpeg" style="width: 40px; height: 40px; background-color: white;" alt="" />
<b  id="nav-username" style="color: white;">Alhattami</b>              
<button type="button"  id="logout" data-bs-toggle="modal"  data-bs-target="" class="btn btn-outline-danger mx-3 fs-5" onclick="outbtn()" >Logout</button>

       </div>

          </div>
        </div>
      </nav>
    </div>
</div>
</div>
 <!-- <div class="bg-black" id="add-btn" data-bs-toggle="modal"  data-bs-target="#create-post-modal" >
    +
  
  </div> -->
<div id="success-alert" class="show fade"  style="position: fixed;font-size: 20px; width:30%; z-index:999999; bottom: 0; right:0"></div>

<div class="container  " >
  <div class="row mt-5 d-flex justify-content-center">
    <div class="col-9">
      <h2>
        <span id="names">
          alaa alhattami
        </span>
        post
      </h2>
    </div> 
  </div>

  <div class="row mt-5 d-flex justify-content-center">
    <div class="col-9" id="post">
    <div class="card shadow my-4">
      <div class="card-header ">
        <img class="rounded-circle border border-2" src="./img_profile/images.png" style="height: 40px; width: 40px;"  alt="">
  <b>@Al-Hattami</b>
      </div>
      <div class="card-body">
        <img src="./img_posts/20230927045127-48abca2c-xs.jpg" style="width: 100%; height: 400px;" alt="">
  <span style="font-size: 17px; color: rgb(157, 155, 155);" >2 min ago</span>   
  <h5>hi alaa alhattami</h5>
  <p style="font-size: 18px;">Lorem, ipsumhsaxjiwqiq  ooAZn dolor sit amet consectetur adipmenda.</p>
  <hr>
  <div class="comment " style="display:flex">
    <box-icon name='message-rounded-dots'>
    </box-icon>
    
    <span class="mx-1">
  
      (5) Comments
    </span>
  </div>
  </div>

  <div id="comments">
    <div class="p-3" style=" background-color: rgb(252, 249, 249);" >
      <div>
    <img src="./img_posts/20230927045127-48abca2c-xs.jpg" class="rounded-circle" style="width: 40px; height: 40px;" alt="">
    <b>
      @alaa alhattami
    </b>
  </div>
  <div>
Lorem ipsum dolor sit, amet consectetur adipisicing elit. Officiis possimus blanditiis voluptatibus similique dignissimos adipisci, ducimus, minima molestias consequatur, corrupti earum eius nobis assumenda qui cumque ex maiores est. Perspiciatis.
  </div>
  <br>
</div>
</div>

</div>

   <!-- comments////// -->
    
  </div>
  </div>
</div>


    </body>
    <script src="./mainlogic.js"></script>
<script>
  const urlparam = new URLSearchParams(window.location.search)
 const postid= urlparam.get("id")
 console.log(postid)
        navbar()


        getPost()
        function getPost(){
  axios.get(`${baseUrl}/posts/${postid}`)
    .then((response)=>{
    const postt= response.data.data
  const comments = postt.comments   
  const author = postt.author
  let Posttitle=" "
  if( postt.title !=null){
     Posttitle= postt.title
  }


  document.getElementById("names").innerHTML=author.username

let commentscontents= ``
for( i of comments){

  commentscontents +=
  `
    <div class="p-3" style="background: #f0ecee;" >
      <div>
    <img src="${i.author.profile_image}" class="rounded-circle" style="width:40px; height: 40px;" alt="">
    <b>
      ${i.author.username}
    </b>
  </div>
  <div>
${i.body} 
</div>
</div>
  `
}
  let content =`
  
   <div class="card shadow my-4">
      <div class="card-header ">
        <img class="rounded-circle border border-2" src="${author.profile_image}" style="height: 40px; width: 40px;"  alt="">
  <b>${author.name}</b>
      </div>
      <div class="card-body">
        <img src="${postt.image}" style="width: 100%; height: 400px;" alt="">
  <span style="font-size: 17px; color: rgb(157, 155, 155);" >2 min ago</span>   
  <h5>${Posttitle}</h5>
  <p style="font-size: 18px;">${postt.body}</p>
  <hr>
  <div class="comment " style="display:flex">
    <box-icon name='message-rounded-dots'>
    </box-icon>
    
    <span class="mx-1">
  
      (${postt.comments_count}) Comments
    </span>
  </div>
  </div>
    <div id="comments">
${commentscontents}

    </div>
<div class="input-group mb-2 " id="addcomments">
  <input id="input-comm" placeholder="add your comments here..." class="form-control"/>
<button type="button" class="btn btn-outline-primary fs-5 fw-bolder" onclick="commentsend()">Send</button>
  </div>
    </div>
  `
  document.getElementById("post").innerHTML=content

})
  }

  function commentsend(){
let comm= document.getElementById("input-comm").value

let params={
  "body":comm
}
let token= localStorage.getItem("token")
let url=`${baseUrl}/posts/${postid}/comments`
axios.post(url,params, {
  headers:{
    "authorization":`Bearer ${token}`
  }
}).then(()=>{
  showmodal("تم اضافة التعليق بنجاح","success")
  getPost()

})
.catch((error)=>{
  let errormesage=error.response.data.message
  showmodal(errormesage,"danger")

})
}

function loaderr(show=true){
  if(show){
    document.getElementById("loader").style.visibility="visible"

  }else{
    document.getElementById("loader").style.visibility="hidden"

  }
 }

</script>
</html>